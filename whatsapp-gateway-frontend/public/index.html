<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#5D5CDE" />
    <meta name="description" content="WhatsApp Gateway Manager - Headless Multi Session WhatsApp Gateway dengan React" />
    
    <title>WhatsApp Gateway Manager</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Config -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#5D5CDE'
            }
          }
        },
        darkMode: 'class'
      }
    </script>
    
    <!-- Loading Styles -->
    <style>
      /* Initial loading screen */
      #initial-loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #5D5CDE 0%, #4f46e5 25%, #7c3aed 75%, #a855f7 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.5s ease-out;
      }
      
      #initial-loader.fade-out {
        opacity: 0;
        pointer-events: none;
      }
      
      .loader-content {
        text-align: center;
        color: white;
      }
      
      .loader-spinner {
        width: 60px;
        height: 60px;
        border: 3px solid rgba(255,255,255,0.3);
        border-radius: 50%;
        border-top: 3px solid white;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      /* Dark mode detection styles */
      @media (prefers-color-scheme: dark) {
        html {
          color-scheme: dark;
        }
      }
      
      /* Prevent flash of unstyled content */
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
          'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
          sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        overflow: hidden;
      }
      
      body.loaded {
        overflow: visible;
      }
      
      /* Hide root until React loads */
      #root {
        opacity: 0;
        transition: opacity 0.3s ease-in;
      }
      
      #root.visible {
        opacity: 1;
      }
    </style>
  </head>
  <body>
    <noscript>
      <div style="padding: 20px; text-align: center; font-family: Arial, sans-serif;">
        <h1>JavaScript Required</h1>
        <p>You need to enable JavaScript to run this WhatsApp Gateway application.</p>
      </div>
    </noscript>
    
    <!-- Initial Loading Screen -->
    <div id="initial-loader">
      <div class="loader-content">
        <div class="loader-spinner"></div>
        <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">WhatsApp Gateway</div>
        <div style="font-size: 14px; opacity: 0.8;">Loading application...</div>
      </div>
    </div>
    
    <!-- React App Root -->
    <div id="root"></div>
    
    <!-- Loading Script -->
    <script>
      // Show loading screen while React loads
      window.addEventListener('DOMContentLoaded', function() {
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.documentElement.classList.add('dark');
        }
        
        // Listen for dark mode changes
        const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
        const handleChange = (event) => {
          if (event.matches) {
            document.documentElement.classList.add('dark');
          } else {
            document.documentElement.classList.remove('dark');
          }
        };
        
        if (mediaQuery.addEventListener) {
          mediaQuery.addEventListener('change', handleChange);
        } else {
          mediaQuery.addListener(handleChange);
        }
        
        // Hide loading screen when React is ready
        const checkReactReady = () => {
          const root = document.getElementById('root');
          if (root && root.children.length > 0) {
            const loader = document.getElementById('initial-loader');
            root.classList.add('visible');
            document.body.classList.add('loaded');
            
            setTimeout(() => {
              loader.classList.add('fade-out');
              setTimeout(() => {
                loader.style.display = 'none';
              }, 500);
            }, 500);
          } else {
            setTimeout(checkReactReady, 100);
          }
        };
        
        // Start checking after a brief delay
        setTimeout(checkReactReady, 1000);
      });
      
      // Fallback: Hide loading screen after 10 seconds regardless
      setTimeout(function() {
        const loader = document.getElementById('initial-loader');
        const root = document.getElementById('root');
        if (loader && loader.style.display !== 'none') {
          loader.classList.add('fade-out');
          root.classList.add('visible');
          document.body.classList.add('loaded');
          setTimeout(() => {
            loader.style.display = 'none';
          }, 500);
        }
      }, 10000);
    </script>
  </body>
</html>